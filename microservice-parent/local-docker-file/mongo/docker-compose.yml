version: '3.9'

# Define services (containers) that will run as part of the microservices stack.
services:

 mongodb:
   image: mongo:latest
   ports:
    - "27018:27017"
   environment:
    - MONGO_INITDB_ROOT_USERNAME=admin
    - MONGO_INITDB_ROOT_PASSWORD=password
   volumes:
    - ./data/mongo/products:/data/db  # The database will persist data here on the host machine.
    - ./init/mongo/docker-entrypoint-initdb.d/mongo-init.js:/docker-entrypoint-initdb.d/mongo-init.js:ro  # Initialize MongoDB with data from this script.
   container_name: mongodb
  #restart: unless-stopped  # The container will restart if it crashes or the Docker daemon restarts.
  #command: mongod --auth  # Ensures MongoDB requires authentication.
   networks:
    - spring

 mongo-express:
   image: mongo-express
   ports:
    - "8081:8081"
   environment:
    - ME_CONFIG_MONGODB_ADMINUSERNAME=admin
    - ME_CONFIG_MONGODB_ADMINPASSWORD=password
    - ME_CONFIG_MONGODB_SERVER=mongodb  # Connect Mongo-Express to the MongoDB container by name.
   container_name: mongo-express
  #restart: unless-stopped
   depends_on:
    - mongodb
   networks:
    - spring